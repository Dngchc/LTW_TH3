{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { fetchModel } from \"../../lib/fetchModelData\";\nimport { Link } from \"react-router-dom\";\nconst UserList = () => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    fetchModel(\"/user/list\").then(async data => {\n      if (!data) {\n        setError(\"Không thể tải danh sách người dùng.\");\n        return;\n      }\n      const usersWithCounts = await Promise.all(data.map(async user => {\n        const photos = await fetchModel(`/photos/photosOfUser/${user._id}`);\n        const photoCount = photos ? photos.length : 0;\n        const commentCount = photos ? photos.reduce((sum, p) => sum + (p.comments ? p.comments.filter(c => c.user._id === user._id).length : 0), 0) : 0;\n        return {\n          ...user,\n          photoCount,\n          commentCount\n        };\n      }));\n      setUsers(usersWithCounts);\n    }).catch(err => {\n      setError(\"Lỗi khi tải danh sách người dùng: \" + err.message);\n    });\n  }, []);\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", null, error);\n  }\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"h2\", null, \"Danh sách người dùng\"), users.length === 0 ? /*#__PURE__*/React.createElement(\"p\", null, \"Không có người dùng nào.\") : /*#__PURE__*/React.createElement(\"ul\", null, users.map(user => /*#__PURE__*/React.createElement(\"li\", {\n    key: user._id,\n    style: {\n      marginBottom: \"10px\"\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/user/${user._id}`\n  }, `${user.first_name} ${user.last_name}`), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"green\",\n      marginLeft: \"10px\"\n    }\n  }, ` (${user.photoCount})`), /*#__PURE__*/React.createElement(Link, {\n    to: `/comments/${user._id}`\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: \"red\",\n      marginLeft: \"5px\"\n    }\n  }, ` (${user.commentCount})`))))));\n};\n_s(UserList, \"W8dPUmt9Ai9400zDPm7RH8jUmB4=\");\n_c = UserList;\nexport default UserList;\nvar _c;\n$RefreshReg$(_c, \"UserList\");","map":{"version":3,"names":["React","useState","useEffect","fetchModel","Link","UserList","_s","users","setUsers","error","setError","then","data","usersWithCounts","Promise","all","map","user","photos","_id","photoCount","length","commentCount","reduce","sum","p","comments","filter","c","catch","err","message","createElement","key","style","marginBottom","to","first_name","last_name","color","marginLeft","_c","$RefreshReg$"],"sources":["I:/CODE/LTW/TH3/photo-sharing-app/frontend/src/components/UserList/index.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { fetchModel } from \"../../lib/fetchModelData\";\nimport { Link } from \"react-router-dom\";\n\nconst UserList = () => {\n  const [users, setUsers] = useState([]);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchModel(\"/user/list\")\n      .then(async (data) => {\n        if (!data) {\n          setError(\"Không thể tải danh sách người dùng.\");\n          return;\n        }\n        const usersWithCounts = await Promise.all(\n          data.map(async (user) => {\n            const photos = await fetchModel(`/photos/photosOfUser/${user._id}`);\n            const photoCount = photos ? photos.length : 0;\n            const commentCount = photos\n              ? photos.reduce(\n                  (sum, p) =>\n                    sum +\n                    (p.comments\n                      ? p.comments.filter((c) => c.user._id === user._id).length\n                      : 0),\n                  0\n                )\n              : 0;\n            return { ...user, photoCount, commentCount };\n          })\n        );\n        setUsers(usersWithCounts);\n      })\n      .catch((err) => {\n        setError(\"Lỗi khi tải danh sách người dùng: \" + err.message);\n      });\n  }, []);\n\n  if (error) {\n    return React.createElement(\"div\", null, error);\n  }\n\n  return React.createElement(\n    \"div\",\n    null,\n    React.createElement(\"h2\", null, \"Danh sách người dùng\"),\n    users.length === 0\n      ? React.createElement(\"p\", null, \"Không có người dùng nào.\")\n      : React.createElement(\n          \"ul\",\n          null,\n          users.map((user) =>\n            React.createElement(\n              \"li\",\n              { key: user._id, style: { marginBottom: \"10px\" } },\n              React.createElement(\n                Link,\n                { to: `/user/${user._id}` },\n                `${user.first_name} ${user.last_name}`\n              ),\n              React.createElement(\n                \"span\",\n                { style: { color: \"green\", marginLeft: \"10px\" } },\n                ` (${user.photoCount})`\n              ),\n              React.createElement(\n                Link,\n                { to: `/comments/${user._id}` },\n                React.createElement(\n                  \"span\",\n                  { style: { color: \"red\", marginLeft: \"5px\" } },\n                  ` (${user.commentCount})`\n                )\n              )\n            )\n          )\n        )\n  );\n};\n\nexport default UserList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}